---
title: "Duke Sports Analtyics: Volleyball Project (Fall 2021)"
description: |
  Exploring Duke Women's Volleyball statistics
author: Hillary Lee, Angel Chaudhary, Aditya Sardesai, Ethan Ouellette, Ashrit Verma
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE,
                      comment = NA, tidy = "styler",
                      fig.width = 8, fig.height = 5)
```

# Introduction

Volleyball is heavily underdeveloped in terms of sports-statistics, which has
prompted us to start this project that aims to develop a WAR-like metric for
volleyball based on statistics from Duke Women's Volleyball for seasons
2018~2021. It will provide a comprehensive and hollistic approach in evaluating
players' strength and performance.

This is an explanation of the data provided on the Duke website based on the
FIVB VIS (Volleyball Information System):

| ATTACK           | Description                                               |
|------------------|-----------------------------------------------------------|
| Kills or Spikes  | Number of scoring attacks.                                |
| Errors or Faults | Number of attacking errors. The opponent scores directly. |
| Attempts         | Total number of attacks.                                  |
| Percent          | Percentage of kills out of attempts.                      |
| Kills Per Set    | Average number of scoring attacks per set.                |

| SET                  | Description                                                  |
|----------------------|--------------------------------------------------------------|
| Assists              | Number of set assists.                                       |
| Assists Per Set      | Number of set assists per set.                               |
| Ball Handling Errors | Number of mistakes in setting. The opponent scores directly. |

| SERVE        | Description                                      |
|--------------|--------------------------------------------------|
| Aces         | Number of points directly scored by the service. |
| Errors       | Number of service mistakes.                      |
| Aces Per Set | Average number of serve aces per set.            |

| RECEPTIONS     | Description                                 |
|----------------|---------------------------------------------|
| Errors         | Number of reception errors.                 |
| Errors Per Set | Average number of reception errors per set. |

| DEFENSE      | Description                     |
|--------------|---------------------------------|
| Digs         | Number of outstanding digs.     |
| Digs Per Set | Average number of digs per set. |

# Scraping Data

```{r packages, message = FALSE}
library(tidyverse)
```

The data is scraped from Duke Sport's website: https://goduke.com/sports/vb/stats/2021?path=vb.

## Duke Data

```{r read-duke-data}
url <- "https://goduke.com/sports/vb/stats/2021?path=vb"
Team_data_2021 <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble() %>% 
  select(-opponents_opp) %>% 
  rename("2021" = duke)

url <- "https://goduke.com/sports/womens-volleyball/stats/2020"
Team_data_2020 <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble() %>% 
  select(-opponents_opp) %>% 
  rename("2020" = duke)

url <- "https://goduke.com/sports/womens-volleyball/stats/2019"
Team_data_2019 <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble() %>% 
  select(-opponents_opp) %>% 
  rename("2019" = duke)

Team_data_compiled <- left_join(left_join(Team_data_2021, Team_data_2020), Team_data_2019)

Team_data_compiled
```

## NCAA Data

```{r read-ncaa-data}
url <- "https://www.ncaa.com/stats/volleyball-women/d1/current/team/48"
NCAA_aces_per_set <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble() %>% 
  rename(per_set = )

url <- "https://www.ncaa.com/stats/volleyball-women/d1/current/team/49"
NCAA_blocks_per_set <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble()

url <- "https://www.ncaa.com/stats/volleyball-women/d1/current/team/50"
NCAA_digs_per_set <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble()

url <- "https://www.ncaa.com/stats/volleyball-women/d1/current/team/47"
NCAA_assists_per_set <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble()

url <- "https://www.ncaa.com/stats/volleyball-women/d1/current/team/46"
NCAA_kills_per_set <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble()

url <- "https://www.ncaa.com/stats/volleyball-women/d1/current/team/45"
NCAA_hitting_percentage <- xml2::read_html(url) %>% 
  rvest::html_table(fill = T) %>% 
  purrr::pluck(1) %>% 
  janitor::clean_names() %>% 
  dplyr::as_tibble()

NCAA_aces_per_set
NCAA_blocks_per_set
NCAA_digs_per_set
NCAA_assists_per_set
NCAA_kills_per_set
NCAA_hitting_percentage
```

```{r nitty-gritty}
library(readxl)
nitty_gritties <- read_excel("data/nitty_gritties.xlsx")
nitty_gritties

full_nitty_gritties <- read_excel("data/NCAA_Statistics.xlsx")
full_nitty_gritties
```

This data shows the RPI (rating percentage index) data for the AAC conference, 
where Duke currently ranks 62nd in. The RPI is a quantity used to rank sports 
teams based upon a team's wins and losses and its strength of schedule.

# Data Visualization

# Plotting hitting % vs. win %
```{r}
library(ggplot2)
lookup <- full_nitty_gritties[ ,c("Team", "Adj. RPI Value")]
hitting_pct <- NCAA_hitting_percentage[, c("team", "pct")]
hitting_pct_rpi <- merge(lookup, hitting_pct, by.x="Team", by.y="team")
names(hitting_pct_rpi)[2] <- "rpi"

ggplot2(hitting_pct_rpi, aes(pct, rpi)) + geom_point()
```

# Offense and Defense stats

```{r offense}
NCAA_aces_per_set %>% 
  inner_join(NCAA_kills_per_set, by = "team") 
```

Service aces, kills, and hitting percentage are offensive stats that are compiled.


```{r defense}
NCAA_blocks_per_set %>% 
  inner_join(NCAA_digs_per_set, by = "team") 
```

Blocks and digs are defensive stats that are compiled.

# Analysis

This section will be an analysis.

# Summary

